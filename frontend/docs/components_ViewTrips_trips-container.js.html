<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/ViewTrips/trips-container.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/ViewTrips/trips-container.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React from 'react';

import app from '../Firebase/';

import * as DB from '../../constants/database.js';
import { getCurUserUid } from '../Utils/temp-auth-utils.js'
import Trip from './trip.js';

const db = app.firestore();

/**
 * Returns a `&lt;div>` element with the specified error message.
 *
 * TODO(Issue #9.): Turn this func into component and add to Errors directory.
 *
 * @param {string} error Error message in `componentDidMount` catch statement.
 * @return {Promise&lt;HTMLDivElement>} Promise object containing a `&lt;div>` element
 *    with the error message `error` inside.
 */
function getErrorElement(error) {
  return new Promise(function(resolve) {
    console.log(`Error in Trips Container: ${error}`);
    resolve(
      &lt;div>
        &lt;p>Oops, it looks like we were unable to load your trips.
                      Please wait a few minutes and try again.
        &lt;/p>
      &lt;/div>
  );
  });
}

/**
 * Component corresponding to the container containing a user's trips.
 * props
 *
 * @property {Object} props These are the props for this component:
 * @property {Function} props.handleEditTrip Event handler responsible for
 *     displaying the edit trip modal.
 * @extends React.Component
 */
class TripsContainer extends React.Component {
  /** @override */
  constructor(props) {
    super(props);
    this.state = {trips: []};
  }

  /**
   * When the TripsContainer mounts, a listener is attached to the QuerySnapshot
   * event that grabs all trip documents where the current user uid is contained
   * in the collaborator uid array (collaborators field). This allows real-time
   * updates for all collaborators on a trip whenever a trip is updated (add,
   * edit, or delete).
   *
   * In the case where there is an error, an error component is returned in
   * place of the array of trips.
   *
   * @override
   */
  async componentDidMount() {
    const curUserUid = getCurUserUid();

    db.collection(DB.COLLECTION_TRIPS)
        .where(DB.TRIPS_COLLABORATORS, 'array-contains', curUserUid)
        .orderBy(DB.TRIPS_UPDATE_TIMESTAMP, 'desc')
        .onSnapshot(querySnapshot => {
          const tripsContainer = querySnapshot.docs.map(doc =>
              ( &lt;Trip
                  tripData={doc.data()}
                  tripId={doc.id}
                  handleEditTrip={this.props.handleEditTrip}
                  key={doc.id}
                />
              )
          );

          this.setState({ trips: tripsContainer });
        }, async (error) => {
          const errorElement = await getErrorElement(error);
          this.setState({ trips: errorElement });
        });
  }

  /** @override */
  render() {
    return (
      &lt;div>{this.state.trips}&lt;/div>
    );
  }
}

export default TripsContainer;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Activity.html">Activity</a></li><li><a href="ActivityDay.html">ActivityDay</a></li><li><a href="ActivityList.html">ActivityList</a></li><li><a href="App.html">App</a></li><li><a href="Header.html">Header</a></li><li><a href="Landing.html">Landing</a></li><li><a href="SaveTripModal.html">SaveTripModal</a></li><li><a href="SignIn.html">SignIn</a></li><li><a href="TripsContainer.html">TripsContainer</a></li><li><a href="UserInfo.html">UserInfo</a></li><li><a href="ViewActivities.html">ViewActivities</a></li><li><a href="ViewTrips.html">ViewTrips</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AuthProvider">AuthProvider</a></li><li><a href="global.html#AuthUtilsConsumer">AuthUtilsConsumer</a></li><li><a href="global.html#COLLECTION_TRIPS">COLLECTION_TRIPS</a></li><li><a href="global.html#compareActivities">compareActivities</a></li><li><a href="global.html#createDateFormControl">createDateFormControl</a></li><li><a href="global.html#createEmailFormControl">createEmailFormControl</a></li><li><a href="global.html#createFormGroup">createFormGroup</a></li><li><a href="global.html#createMultiFormControl">createMultiFormControl</a></li><li><a href="global.html#createTextFormControl">createTextFormControl</a></li><li><a href="global.html#deleteQueryBatch">deleteQueryBatch</a></li><li><a href="global.html#deleteTrip">deleteTrip</a></li><li><a href="global.html#deleteTripActivities">deleteTripActivities</a></li><li><a href="global.html#DeleteTripsButton">DeleteTripsButton</a></li><li><a href="global.html#formatTripData">formatTripData</a></li><li><a href="global.html#getActivityList">getActivityList</a></li><li><a href="global.html#getCleanedTextInput">getCleanedTextInput</a></li><li><a href="global.html#getCollaboratorEmails">getCollaboratorEmails</a></li><li><a href="global.html#getCollaboratorUidArray">getCollaboratorUidArray</a></li><li><a href="global.html#getCurrentUser">getCurrentUser</a></li><li><a href="global.html#getCurUserDisplayName">getCurUserDisplayName</a></li><li><a href="global.html#getCurUserEmail">getCurUserEmail</a></li><li><a href="global.html#getCurUserPhotoUrl">getCurUserPhotoUrl</a></li><li><a href="global.html#getCurUserUid">getCurUserUid</a></li><li><a href="global.html#getDateRangeString">getDateRangeString</a></li><li><a href="global.html#getErrorElement">getErrorElement</a></li><li><a href="global.html#getField">getField</a></li><li><a href="global.html#getTimestampFromDateString">getTimestampFromDateString</a></li><li><a href="global.html#getUserEmailArrFromUserUidArr">getUserEmailArrFromUserUidArr</a></li><li><a href="global.html#getUserUidArrFromUserEmailArr">getUserUidArrFromUserEmailArr</a></li><li><a href="global.html#handleAuthError">handleAuthError</a></li><li><a href="global.html#isUserLoggedIn">isUserLoggedIn</a></li><li><a href="global.html#LANDING">LANDING</a></li><li><a href="global.html#PrivateRoute">PrivateRoute</a></li><li><a href="global.html#redirectToSignIn">redirectToSignIn</a></li><li><a href="global.html#SignInButton">SignInButton</a></li><li><a href="global.html#sortByDate">sortByDate</a></li><li><a href="global.html#sum">sum</a></li><li><a href="global.html#timestampToDateFormatted">timestampToDateFormatted</a></li><li><a href="global.html#timestampToFormatted">timestampToFormatted</a></li><li><a href="global.html#timestampToISOString">timestampToISOString</a></li><li><a href="global.html#timestampToTimeFormatted">timestampToTimeFormatted</a></li><li><a href="global.html#timezonePicker">timezonePicker</a></li><li><a href="global.html#Trip">Trip</a></li><li><a href="global.html#ViewActivitiesButton">ViewActivitiesButton</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Sun Jul 26 2020 12:27:29 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
